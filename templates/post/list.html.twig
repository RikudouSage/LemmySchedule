{% extends "base.html.twig" %}

{% block title %}{{ "Scheduled posts" | trans }}{% endblock %}

{% block body %}
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">
                <table class="table table-bordered">
                    <thead>
                    <tr>
                        <th>{{ "Community" | trans }}</th>
                        <th>{{ "Title" | trans }}</th>
                        <th>{{ "Scheduled at" | trans }}</th>
                        <th>{{ "Cancel" | trans }}</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td colspan="4">
                            <a class="btn btn-primary"
                               href="{{ path('app.post.create') }}">{{ "Schedule a post" | trans }}</a>
                        </td>
                    </tr>
                    {% for job in jobs %}
                        <tr {{ stimulus_controller('scheduled-job', {
                            cancelUrl: path('app.post.ajax.cancel', {
                                jobId: job.jobId,
                            }),
                            errorDeletingText: "There was an error when cancelling the job." | trans,
                        }) }}>
                            <td>
                                <a href="{{ path('app.post.detail', {jobId: job.jobId}) }}">
                                    {{ job.title }}
                                </a>
                            </td>
                            <td>{{ job.community }}</td>
                            <td {{ stimulus_target('scheduled-job', 'dateTime') }}>{{ job.dateTime | date('c') }}</td>
                            <td>
                                <button class="btn btn-danger" type="button" {{ stimulus_action('scheduled-job', 'cancel') }}>
                                    {{ "Cancel" | trans }}
                                </button>
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="4">
                                {{ "You have no scheduled posts." | trans }}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}
